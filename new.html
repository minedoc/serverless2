<!doctype html>
<script type="module">
import {init} from './init.js';
init();
</script>

<pre id="out">
foo = undefined
</pre>

<pre>
TODO
  webrtc: can we use announce people count to detect when to offer
  trivial clock overrun attack prevents writing

minimal sync
  no query
    map and filter the Dict yourself
    no indexes
  no realtime query
    re-query to get new values
  no ui
    this is a db
  no schema
    that's a bad idea
  no await
    data stored in memory, indexed db is persistence only
  no concurrency
    use transactions when modifying idb to ensure correctness
  no dag
    changes are self sufficient
    last writer wins
    cannot statically detect conflicting edits
      normal writes form linked list
      conficting writes form tree
  yes encryption - but later
    read control via rpc encryption - done
    write control via digital signature - future
      change = message(signature, repeated edit)
  no strings - for now
    future: accumulating set of edits, apply library or replicated growable arrays

correctness
  multiple unsynchronized users of idb
  idb changes are not pushed to other users
  local sync with idb
    changes: writes are key hashed thus idempotent
    tables: use indexeddb transaction compare clock and overwrite

data model
  tables of lww rows
  API
    table(table)
    table(table).insert(value) returns key
    table(table).update(key, value)
    table(table).remove(key)

</pre>
